# エラーハンドリング設計
## バックエンド側（Spring Boot）
| 種類         | 発生箇所             | ハンドリング方法                  | レスポンス例                                        |
| ---------- | ---------------- | ------------------------- | --------------------------------------------- |
| バリデーションエラー | Task作成、Session開始 | @Valid + ExceptionHandler | 400 Bad Request {"error":"タスク名必須"}            |
| 排他制約違反     | Session開始（二重押し）  | DB制約例外捕捉、カスタムメッセージ        | 409 Conflict {"error":"既に実行中のセッションがあります"}     |
| 存在しないID    | Task詳細取得         | NotFoundException         | 404 Not Found {"error":"タスクが存在しません"}          |
| DB接続失敗     | CRUD操作           | 例外捕捉 + ログ                 | 500 Internal Server Error {"error":"DB接続エラー"} |
| 想定外エラー     | 全体               | @ControllerAdvice でキャッチ   | 500 Internal Server Error {"error":"予期せぬエラー"} |
## フロントエンド側（React + Capacitor）
| 種類       | 発生箇所          | ハンドリング方法             |
| -------- | ------------- | -------------------- |
| API通信エラー | fetch / axios | トースト表示、リトライボタン       |
| 排他制御違反   | 計測開始          | ボタンを非活性化 + エラーメッセージ  |
| バリデーション  | タスク名入力        | 入力時リアルタイムチェック        |
| 想定外      | 画面表示          | 例外キャッチ + 共通エラーモーダル表示 |
## 画面ごとのエラー対応
| 画面          | 例外ケース       | 表示方法                  |
| ----------- | ----------- | --------------------- |
| Task一覧      | Task取得失敗    | 「タスク一覧の取得に失敗しました」トースト |
| Task詳細      | Session開始失敗 | 「他のセッションが進行中です」モーダル   |
| TaskEvent履歴 | 履歴取得失敗      | 「履歴を取得できませんでした」トースト   |
### 注意点
1. DB制約・状態遷移ルールに違反する操作は必ずバックエンドで弾く
2. フロント側はユーザーへのフィードバックを中心に担当
3. エラーは種類ごとに HTTPステータス・JSON メッセージを統一